<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Linear regression | Tutorial notes for Biostatistics II</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Linear regression | Tutorial notes for Biostatistics II" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Linear regression | Tutorial notes for Biostatistics II" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Juan Pablo Diaz Martinez" />


<meta name="date" content="2021-01-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="logistic-regression.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tutorial notes for Biostats II</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Statistical inference</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#sampling-distribution"><i class="fa fa-check"></i><b>2.1</b> Sampling distribution</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#estimates-and-standard-erors"><i class="fa fa-check"></i><b>2.2</b> Estimates and standard erors</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>3</b> Linear regression</a><ul>
<li class="chapter" data-level="3.1" data-path="linear-regression.html"><a href="linear-regression.html#background"><i class="fa fa-check"></i><b>3.1</b> Background</a></li>
<li class="chapter" data-level="3.2" data-path="linear-regression.html"><a href="linear-regression.html#simple-regression-with-fake-data"><i class="fa fa-check"></i><b>3.2</b> Simple regression with fake data</a></li>
<li class="chapter" data-level="3.3" data-path="linear-regression.html"><a href="linear-regression.html#interpretation-of-coefficients-and-model-diagnostics"><i class="fa fa-check"></i><b>3.3</b> Interpretation of coefficients and model diagnostics</a></li>
<li class="chapter" data-level="3.4" data-path="linear-regression.html"><a href="linear-regression.html#outliers-and-how-to-diagnose-them"><i class="fa fa-check"></i><b>3.4</b> Outliers and how to diagnose them</a><ul>
<li class="chapter" data-level="3.4.1" data-path="linear-regression.html"><a href="linear-regression.html#studentized-residuals"><i class="fa fa-check"></i><b>3.4.1</b> Studentized residuals</a></li>
<li class="chapter" data-level="3.4.2" data-path="linear-regression.html"><a href="linear-regression.html#difference-in-fits-dffits"><i class="fa fa-check"></i><b>3.4.2</b> Difference in Fits (DFFITS)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>4</b> Logistic regression</a><ul>
<li class="chapter" data-level="4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#interpretation-of-coefficients-and-model-diagnostics-1"><i class="fa fa-check"></i><b>4.1</b> Interpretation of coefficients and model diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>5</b> Generalized linear models</a><ul>
<li class="chapter" data-level="5.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#introduction-1"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#poisson-regression"><i class="fa fa-check"></i><b>5.2</b> Poisson regression</a><ul>
<li class="chapter" data-level="5.2.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#exposure"><i class="fa fa-check"></i><b>5.2.1</b> Exposure</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#negative-binomial-regression-model"><i class="fa fa-check"></i><b>5.3</b> Negative Binomial regression model</a></li>
<li class="chapter" data-level="5.4" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#example-pest-management-on-roaches-reducing-cockroach-level"><i class="fa fa-check"></i><b>5.4</b> Example: pest management on Roaches reducing cockroach level</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tutorial notes for Biostatistics II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Linear regression</h1>
<div id="background" class="section level2">
<h2><span class="header-section-number">3.1</span> Background</h2>
<ul>
<li>Simplest regression model: <span class="math inline">\(y=a+bx+error\)</span></li>
<li>Additional predictors: : <span class="math inline">\(y=\beta_0+\beta_1x_1+...+\beta_kx_k+error\)</span></li>
<li>Nonlinear models: <span class="math inline">\(\log y=a+b \log x+error\)</span></li>
<li>Nonadditive models: <span class="math inline">\(y=\beta_0+\beta_1x_1+\beta_2x_2+\beta_3x_1x_2+error\)</span></li>
<li>Generalized linear models: Non-normal additive errors with a function that “links” the linear predictor with the outcome.</li>
</ul>
</div>
<div id="simple-regression-with-fake-data" class="section level2">
<h2><span class="header-section-number">3.2</span> Simple regression with fake data</h2>
<p>Same as Chapter <a href="intro.html#intro">2</a></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="linear-regression.html#cb4-1"></a>x=<span class="dv">1</span><span class="op">:</span><span class="dv">20</span></span>
<span id="cb4-2"><a href="linear-regression.html#cb4-2"></a>n=<span class="kw">length</span>(x)</span>
<span id="cb4-3"><a href="linear-regression.html#cb4-3"></a>a=<span class="fl">0.2</span></span>
<span id="cb4-4"><a href="linear-regression.html#cb4-4"></a>b=<span class="fl">0.3</span></span>
<span id="cb4-5"><a href="linear-regression.html#cb4-5"></a>sigma=<span class="fl">0.5</span></span>
<span id="cb4-6"><a href="linear-regression.html#cb4-6"></a>y=a <span class="op">+</span><span class="st"> </span>b<span class="op">*</span>x <span class="op">+</span><span class="st"> </span>sigma<span class="op">*</span><span class="kw">rnorm</span>(n)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="linear-regression.html#cb5-1"></a>fit=<span class="kw">lm</span>(y<span class="op">~</span>x)</span>
<span id="cb5-2"><a href="linear-regression.html#cb5-2"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.2818 -0.3297  0.1485  0.3455  0.7723 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.24254    0.26314   0.922    0.369    
## x            0.29985    0.02197  13.650 6.18e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5665 on 18 degrees of freedom
## Multiple R-squared:  0.9119, Adjusted R-squared:  0.907 
## F-statistic: 186.3 on 1 and 18 DF,  p-value: 6.177e-11</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-5">Table 3.1: </span>95% CI for intercept and slope</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">2.5 %</th>
<th align="right">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.3103012</td>
<td align="right">0.7953908</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">0.2537007</td>
<td align="right">0.3460021</td>
</tr>
</tbody>
</table>
<p><em>Questions</em></p>
<ol style="list-style-type: decimal">
<li>Are estimates consistent with true values?</li>
<li>What can you tell about the uncertainty surrounding the coefficients?</li>
</ol>
<p>We can also plot the data and fitter regression line (Figure <a href="linear-regression.html#fig:fig1">3.1</a>).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="linear-regression.html#cb7-1"></a><span class="kw">plot</span>(x, y, <span class="dt">main=</span><span class="st">&quot;Data and fitted regression line&quot;</span>)</span>
<span id="cb7-2"><a href="linear-regression.html#cb7-2"></a>a_hat=<span class="kw">coef</span>(fit)[<span class="dv">1</span>]</span>
<span id="cb7-3"><a href="linear-regression.html#cb7-3"></a>b_hat=<span class="kw">coef</span>(fit)[<span class="dv">2</span>]</span>
<span id="cb7-4"><a href="linear-regression.html#cb7-4"></a><span class="kw">abline</span>(a_hat, b_hat)</span></code></pre></div>
<div class="figure"><span id="fig:fig1"></span>
<img src="Notes_files/figure-html/fig1-1.png" alt="Observed and fitted" width="672" />
<p class="caption">
Figure 3.1: Observed and fitted
</p>
</div>
</div>
<div id="interpretation-of-coefficients-and-model-diagnostics" class="section level2">
<h2><span class="header-section-number">3.3</span> Interpretation of coefficients and model diagnostics</h2>
<p><em>Linear regression assumptions</em></p>
<ol style="list-style-type: decimal">
<li>Normality of residuals.</li>
<li>Linear relationship.</li>
<li>Constant variance.</li>
<li><span class="math inline">\(y_i\)</span> are independent.</li>
</ol>
<p>Let’s start using real data. Below we can see a brief description about the dataset used in this example.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="linear-regression.html#cb8-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;datarium&quot;</span>) <span class="co"># Install to access the dataset</span></span>
<span id="cb8-2"><a href="linear-regression.html#cb8-2"></a>?marketing <span class="co">#description of the dataset</span></span>
<span id="cb8-3"><a href="linear-regression.html#cb8-3"></a><span class="kw">library</span>(datarium)</span>
<span id="cb8-4"><a href="linear-regression.html#cb8-4"></a><span class="kw">head</span>(marketing)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">youtube</th>
<th align="right">facebook</th>
<th align="right">newspaper</th>
<th align="right">sales</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">276.12</td>
<td align="right">45.36</td>
<td align="right">83.04</td>
<td align="right">26.52</td>
</tr>
<tr class="even">
<td align="right">53.40</td>
<td align="right">47.16</td>
<td align="right">54.12</td>
<td align="right">12.48</td>
</tr>
<tr class="odd">
<td align="right">20.64</td>
<td align="right">55.08</td>
<td align="right">83.16</td>
<td align="right">11.16</td>
</tr>
<tr class="even">
<td align="right">181.80</td>
<td align="right">49.56</td>
<td align="right">70.20</td>
<td align="right">22.20</td>
</tr>
<tr class="odd">
<td align="right">216.96</td>
<td align="right">12.96</td>
<td align="right">70.08</td>
<td align="right">15.48</td>
</tr>
<tr class="even">
<td align="right">10.44</td>
<td align="right">58.68</td>
<td align="right">90.00</td>
<td align="right">8.64</td>
</tr>
</tbody>
</table>
<p>We build a model to predict sales on the basis of advertising budget spent in youtube <strong>and</strong> facebook. It is important to notice the nonadditive model used here and the implications of interaction terms.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="linear-regression.html#cb9-1"></a>fit2=<span class="kw">lm</span>(sales <span class="op">~</span><span class="st"> </span>youtube<span class="op">*</span>facebook, <span class="dt">data =</span> marketing)</span>
<span id="cb9-2"><a href="linear-regression.html#cb9-2"></a><span class="kw">summary</span>(fit2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ youtube * facebook, data = marketing)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.6039 -0.4833  0.2197  0.7137  1.8295 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      8.100e+00  2.974e-01  27.233   &lt;2e-16 ***
## youtube          1.910e-02  1.504e-03  12.699   &lt;2e-16 ***
## facebook         2.886e-02  8.905e-03   3.241   0.0014 ** 
## youtube:facebook 9.054e-04  4.368e-05  20.727   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.132 on 196 degrees of freedom
## Multiple R-squared:  0.9678, Adjusted R-squared:  0.9673 
## F-statistic:  1963 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Also we plot some regression diagnostics.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="linear-regression.html#cb11-1"></a><span class="kw">plot</span>(fit2)</span></code></pre></div>
<p><img src="Notes_files/figure-html/fig2-1.png" width="672" /><img src="Notes_files/figure-html/fig2-2.png" width="672" /><img src="Notes_files/figure-html/fig2-3.png" width="672" /><img src="Notes_files/figure-html/fig2-4.png" width="672" /></p>
</div>
<div id="outliers-and-how-to-diagnose-them" class="section level2">
<h2><span class="header-section-number">3.4</span> Outliers and how to diagnose them</h2>
<p>Let’s recall our linear model, i.e., <span class="math inline">\(y_i=a+bx_i+\epsilon_i,\quad \epsilon_i\sim \mathcal{N}(0,\sigma)\)</span>. Why is important to check the outliers after fitting our model? Because sometimes we can encounter potential outliers that could influence the regression model in the sense of pulling our fitted model towards these outliers.</p>
<div id="studentized-residuals" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Studentized residuals</h3>
<p>After fitting our linear model, we get</p>
<p><span class="math display">\[
y_i=\hat{a}+\hat{b}x_i+d_i \implies d_i=y_i-\hat{y_i}
\]</span>
where <span class="math inline">\(d_i\)</span> denotes the residual for observation <span class="math inline">\(i\)</span> and <span class="math inline">\(\hat{y_i}=\hat{a}+\hat{b}x_i\)</span>. Let’s plot again our fitted values vs residuals in our previous model. How large is large?</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="linear-regression.html#cb12-1"></a><span class="kw">plot</span>(fit2,<span class="dv">1</span>)</span></code></pre></div>
<p><img src="Notes_files/figure-html/fig3-1.png" width="672" /></p>
<p>In order to answer the previous question, we standardize our residuals, i.e.,</p>
<p><span class="math display">\[
t_i=\frac{d_i}{sd(d_i)}
\]</span>
This studentized residuals follow a student’s t distribution, i.e., <span class="math inline">\(t_i\sim t_{n-p-1}\)</span> where <span class="math inline">\(p\)</span> is the number of coefficients in our regression model.</p>
<p><strong>Questions</strong></p>
<ol style="list-style-type: decimal">
<li>Why do residuals <span class="math inline">\(&gt;2\)</span> warrant attention?</li>
</ol>
</div>
<div id="difference-in-fits-dffits" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Difference in Fits (DFFITS)</h3>
<p>Are outliers bad when fitting a linear model? Not necessarily. We can have outliers which are not influential in our fitted model. The idea behind diagnosing influential observations is to delete the observations one at a time, each time refitting the regression model on the remaining <span class="math inline">\(n–1\)</span> observations.</p>
<p>The difference in fits for observation <span class="math inline">\(i\)</span>, denoted <span class="math inline">\(DFFITS_i\)</span>, is defined as:</p>
<p><span class="math display">\[
DFFITS_i=\frac{\hat{y_i}-\hat{y}_{(i)}}{sd(\hat{y_i}-\hat{y}_{(i)})}
\]</span>
where <span class="math inline">\(\hat{y}_{(i)}\)</span> denotes the fitted response when observation <span class="math inline">\(i\)</span> is removed. Going back to our previous example, Figure <a href="linear-regression.html#fig:fig4">3.2</a> shows how influential our observations can be</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="linear-regression.html#cb13-1"></a><span class="kw">plot</span>(<span class="kw">dffits</span>(fit2))</span></code></pre></div>
<div class="figure"><span id="fig:fig4"></span>
<img src="Notes_files/figure-html/fig4-1.png" alt="DFFITS" width="672" />
<p class="caption">
Figure 3.2: DFFITS
</p>
</div>
<p><span class="math inline">\(DFFITS_i\)</span> can also be expressed as</p>
<p><span class="math display">\[
DFFITS_i=t_{(i)}\sqrt{\frac{h_{ii}}{1-h_{ii}}}
\]</span></p>
<p>where <span class="math inline">\(t_{(i)}\)</span> is the externally studentized residual and <span class="math inline">\(h_ii\)</span> represents the <strong>leverage</strong>. The leverage <span class="math inline">\(h_ii\)</span> is a measure of the distance between the <span class="math inline">\(x\)</span> value for the <span class="math inline">\(i\)</span>th data point and the mean of the <span class="math inline">\(x\)</span> values for all <span class="math inline">\(n\)</span> data points. For a perfectly balanced experimental design, the leverage for each point is <span class="math inline">\(p/n\)</span>, therefore</p>
<p><span class="math display">\[
DFFITS_i=t_{(i)}\sqrt{\frac{p}{n}}
\]</span></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="logistic-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Notes.pdf", "Notes.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
